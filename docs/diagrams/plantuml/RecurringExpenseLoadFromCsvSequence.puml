@startuml
skinparam backgroundColor #FFFFFF
skinparam sequence {
    ArrowColor #2C3E50
    LifeLineBorderColor #2C3E50
    ParticipantBorderColor #2C3E50
    ParticipantBackgroundColor #FFFFFF
}

participant ":LoadCommand" as LC
participant ":RecurringExpenseList" as REL
participant ":File" as F
participant ":FileReader" as FR
participant ":CSVReader" as CSV
participant ":RecurringExpense" as RE
participant ":LocalDate" as LD

LC -> REL: loadFromCsv(filePath)
activate REL

REL -> F: new File(filePath)
activate F
F --> REL: file
deactivate F

REL -> FR: new FileReader(file)
activate FR
FR --> REL: reader
deactivate FR

REL -> CSV: new CSVReader(reader)
activate CSV
CSV --> REL: csvReader
deactivate CSV

REL -> CSV: readNext()
activate CSV
note right: Skip header
CSV --> REL: header line
deactivate CSV

loop while line = csvReader.readNext() != null
    REL -> CSV: readNext()
    activate CSV
    CSV --> REL: line[]
    deactivate CSV
    
    REL -> REL: addRecurringExpense(line[2], line[1], line[0], line[3], line[4])
end

REL -> FR: close()
activate FR
FR --> REL
deactivate FR

REL -> CSV: close()
activate CSV
CSV --> REL
deactivate CSV

REL -> LD: now()
activate LD
LD --> REL: currentDate
deactivate LD

loop for each RecurringExpense
    REL -> RE: getFrequency()
    activate RE
    RE --> REL: frequency
    deactivate RE
    
    REL -> RE: getlastAddedDate()
    activate RE
    RE --> REL: lastAddedDate
    deactivate RE
    
    alt frequency == "daily"
        REL -> RE: addDailyExpense(lastAddedDate, currentDate)
        activate RE
        RE --> REL
        deactivate RE
    else frequency == "weekly"
        REL -> RE: addWeeklyExpense(lastAddedDate, currentDate)
        activate RE
        RE --> REL
        deactivate RE
    else frequency == "monthly"
        REL -> RE: addMonthlyExpense(lastAddedDate, currentDate)
        activate RE
        RE --> REL
        deactivate RE
    end
end

REL --> LC
deactivate EL
@enduml